<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scraper Builder</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div id="app">
    <!-- Step 1: Metadata -->
    <div id="step-metadata" class="step active">
      <h2>üìã Step 1: Metadata</h2>
      <div class="form-group">
        <label>Jurisdiction Name *</label>
        <input type="text" id="jurisdiction" placeholder="e.g., City of Boston / State of California">
      </div>
      <div class="form-group">
        <label>State Code *</label>
        <select id="state-code">
          <option value="">Select state...</option>
          <option value="AL">AL - Alabama</option>
          <option value="AK">AK - Alaska</option>
          <option value="AZ">AZ - Arizona</option>
          <option value="AR">AR - Arkansas</option>
          <option value="CA">CA - California</option>
          <option value="CO">CO - Colorado</option>
          <option value="CT">CT - Connecticut</option>
          <option value="DE">DE - Delaware</option>
          <option value="FL">FL - Florida</option>
          <option value="GA">GA - Georgia</option>
          <option value="HI">HI - Hawaii</option>
          <option value="ID">ID - Idaho</option>
          <option value="IL">IL - Illinois</option>
          <option value="IN">IN - Indiana</option>
          <option value="IA">IA - Iowa</option>
          <option value="KS">KS - Kansas</option>
          <option value="KY">KY - Kentucky</option>
          <option value="LA">LA - Louisiana</option>
          <option value="ME">ME - Maine</option>
          <option value="MD">MD - Maryland</option>
          <option value="MA">MA - Massachusetts</option>
          <option value="MI">MI - Michigan</option>
          <option value="MN">MN - Minnesota</option>
          <option value="MS">MS - Mississippi</option>
          <option value="MO">MO - Missouri</option>
          <option value="MT">MT - Montana</option>
          <option value="NE">NE - Nebraska</option>
          <option value="NV">NV - Nevada</option>
          <option value="NH">NH - New Hampshire</option>
          <option value="NJ">NJ - New Jersey</option>
          <option value="NM">NM - New Mexico</option>
          <option value="NY">NY - New York</option>
          <option value="NC">NC - North Carolina</option>
          <option value="ND">ND - North Dakota</option>
          <option value="OH">OH - Ohio</option>
          <option value="OK">OK - Oklahoma</option>
          <option value="OR">OR - Oregon</option>
          <option value="PA">PA - Pennsylvania</option>
          <option value="RI">RI - Rhode Island</option>
          <option value="SC">SC - South Carolina</option>
          <option value="SD">SD - South Dakota</option>
          <option value="TN">TN - Tennessee</option>
          <option value="TX">TX - Texas</option>
          <option value="UT">UT - Utah</option>
          <option value="VT">VT - Vermont</option>
          <option value="VA">VA - Virginia</option>
          <option value="WA">WA - Washington</option>
          <option value="WV">WV - West Virginia</option>
          <option value="WI">WI - Wisconsin</option>
          <option value="WY">WY - Wyoming</option>
          <option value="DC">DC - District of Columbia</option>
        </select>
      </div>
      <div class="form-group">
        <label>Level *</label>
        <div class="radio-group">
          <label><input type="radio" name="level" value="state"> State</label>
          <label><input type="radio" name="level" value="local"> Local</label>
          <label><input type="radio" name="level" value="federal"> Federal</label>
        </div>
      </div>
      <div class="form-group">
        <label>Calendar URL *</label>
        <div class="input-with-button">
          <input type="text" id="calendar-url" placeholder="https://example.gov/calendar">
          <button type="button" id="autofill-url" class="btn-secondary">üìç Current URL</button>
        </div>
      </div>
      <div class="form-group">
        <label>Base URL *</label>
        <div class="input-with-button">
          <input type="text" id="base-url" placeholder="https://example.gov">
          <button type="button" id="autofill-base-url" class="btn-secondary">üîó Auto-detect</button>
        </div>
      </div>
      <div class="form-group">
        <label>
          <input type="checkbox" id="requires-js">
          Requires JavaScript (dynamic content)
        </label>
      </div>
      <div class="form-group">
        <label>Notes (optional)</label>
        <textarea id="notes" rows="3" placeholder="Any special considerations..."></textarea>
      </div>
      <button class="btn-primary" id="next-to-calendar">Next: Calendar Structure ‚Üí</button>
    </div>

    <!-- Step 2: Calendar Structure -->
    <div id="step-calendar" class="step">
      <h2>üìÖ Step 2: Calendar Structure</h2>
      <p class="instruction">Click elements on the page to capture their selectors.</p>
      
      <div class="field-capture">
        <h3>Navigation (Optional)</h3>
        <button class="capture-btn" data-field="month-view-button">
          <span class="status">‚≠ï</span> Month View Button
        </button>
        <button class="capture-btn" data-field="next-button">
          <span class="status">‚≠ï</span> Next Month Button
        </button>
        <button class="capture-btn" data-field="prev-button">
          <span class="status">‚≠ï</span> Previous Month Button
        </button>
      </div>

      <div class="field-capture">
        <h3>Event List *</h3>
        <button class="capture-btn required" data-field="event-container">
          <span class="status">‚≠ï</span> Event List Container
        </button>
        <button class="capture-btn required" data-field="event-item">
          <span class="status">‚≠ï</span> Single Event Item
        </button>
        <div id="events-count" class="info-text"></div>
      </div>

      <div class="btn-group">
        <button class="btn-secondary" id="back-to-metadata">‚Üê Back</button>
        <button class="btn-primary" id="next-to-fields">Next: Event Fields ‚Üí</button>
      </div>
    </div>

    <!-- Step 3: Event Fields -->
    <div id="step-fields" class="step">
      <h2>üìù Step 3: Event Fields</h2>
      <p class="instruction">Click on each field within an event to capture it.</p>
      
      <div class="field-capture">
        <h3>Required Fields</h3>
        <button class="capture-btn required" data-field="name">
          <span class="status">‚≠ï</span> Event Name
        </button>
        <button class="capture-btn required" data-field="date">
          <span class="status">‚≠ï</span> Date
        </button>
      </div>

      <div class="field-capture">
        <h3>Recommended Fields</h3>
        <button class="capture-btn" data-field="time">
          <span class="status">‚≠ï</span> Time
        </button>
        <button class="capture-btn" data-field="location">
          <span class="status">‚≠ï</span> Location
        </button>
        <button class="capture-btn" data-field="committee">
          <span class="status">‚≠ï</span> Committee
        </button>
        <button class="capture-btn" data-field="details-link">
          <span class="status">‚≠ï</span> Details Link
        </button>
      </div>

      <div class="field-capture">
        <h3>Optional Fields</h3>
        <button class="capture-btn" data-field="description">
          <span class="status">‚≠ï</span> Description
        </button>
        <button class="capture-btn" data-field="type">
          <span class="status">‚≠ï</span> Event Type
        </button>
        <button class="capture-btn" data-field="virtual-link">
          <span class="status">‚≠ï</span> Virtual Meeting Link
        </button>
      </div>

      <div class="btn-group">
        <button class="btn-secondary" id="back-to-calendar">‚Üê Back</button>
        <button class="btn-primary" id="next-to-details">Next: Details Page ‚Üí</button>
        <button class="btn-secondary" id="skip-details">Skip Details Page</button>
      </div>
    </div>

    <!-- Step 4: Details Page -->
    <div id="step-details" class="step">
      <h2>üîç Step 4: Details Page (Optional)</h2>
      <p class="instruction">Navigate to a details page and capture additional fields.</p>
      
      <div class="form-group">
        <label>
          <input type="checkbox" id="has-details-page">
          This site has separate detail pages
        </label>
      </div>

      <div id="details-fields" style="display: none;">
        <div class="field-capture">
          <h3>Details Page Fields</h3>
          <button class="capture-btn" data-field="agenda-url">
            <span class="status">‚≠ï</span> Agenda/PDF Link
          </button>
          <button class="capture-btn" data-field="docket-url">
            <span class="status">‚≠ï</span> Docket Link
          </button>
          <button class="capture-btn" data-field="details-virtual-link">
            <span class="status">‚≠ï</span> Virtual Meeting Link
          </button>
          <button class="capture-btn" data-field="details-description">
            <span class="status">‚≠ï</span> Full Description
          </button>
        </div>

        <div class="field-capture">
          <h3>Bills/Agenda Items</h3>
          <button class="capture-btn" data-field="bills-container">
            <span class="status">‚≠ï</span> Bill List Container
          </button>
          <button class="capture-btn" data-field="bill-item">
            <span class="status">‚≠ï</span> Single Bill Item
          </button>
          <div id="bills-count" class="info-text"></div>
        </div>

        <div class="field-capture">
          <h3>Bill Fields (within a bill item)</h3>
          <button class="capture-btn" data-field="bill-number">
            <span class="status">‚≠ï</span> Bill Number
          </button>
          <button class="capture-btn" data-field="bill-title">
            <span class="status">‚≠ï</span> Bill Title
          </button>
          <button class="capture-btn" data-field="bill-url">
            <span class="status">‚≠ï</span> Bill Link
          </button>
        </div>
      </div>

      <div class="btn-group">
        <button class="btn-secondary" id="back-to-fields">‚Üê Back</button>
        <button class="btn-primary" id="next-to-review">Next: Review ‚Üí</button>
      </div>
    </div>

    <!-- Step 5: Review & Export -->
    <div id="step-review" class="step">
      <h2>‚úÖ Step 5: Review & Export</h2>
      
      <div id="review-summary" class="review-section">
        <h3>Summary</h3>
        <div id="summary-content"></div>
      </div>

      <div class="review-section">
        <h3>Validation</h3>
        <div id="validation-results"></div>
      </div>

      <div class="review-section">
        <h3>Captured Data Preview</h3>
        <pre id="json-preview"></pre>
      </div>

      <div class="btn-group">
        <button class="btn-secondary" id="back-to-details">‚Üê Back</button>
        <button class="btn-primary" id="export-json">üíæ Export JSON</button>
        <button class="btn-secondary" id="copy-json">üìã Copy to Clipboard</button>
      </div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
