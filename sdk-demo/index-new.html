<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Agent Studio - Local LLM Control</title>
  <link rel="stylesheet" href="style-new.css">
</head>
<body>
  <div class="app-container">
    <!-- Sidebar for Context & Settings -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <h2>ğŸ¤– Agent Studio</h2>
        <button id="new-chat-btn" class="btn btn-primary">+ New Chat</button>
      </div>

      <!-- Tab Selector -->
      <div class="sidebar-tabs">
        <button class="sidebar-tab active" data-tab="chat">ğŸ’¬ Chat</button>
        <button class="sidebar-tab" data-tab="agent-editor">ğŸ¤– Agent Editor</button>
        <button class="sidebar-tab" data-tab="templates">ğŸ­ Templates</button>
        <button class="sidebar-tab" data-tab="builder">ğŸ› ï¸ Builder</button>
        <button class="sidebar-tab" data-tab="workflows">ğŸ”„ Workflows</button>
      </div>

      <!-- Chat Tab Content -->
      <div class="sidebar-content" id="chat-tab" style="display: block;">
        <!-- Agent Configuration -->
        <div class="sidebar-section">
          <h3>ğŸ¯ Agent Mode</h3>
          <select id="agent-mode" class="select-input">
            <option value="general">ğŸ’¬ General Assistant</option>
            <option value="code-generator">ğŸ’» Code Generator</option>
            <option value="web-scraper">ğŸ•·ï¸ Web Scraper</option>
            <option value="data-analyst">ğŸ“Š Data Analyst</option>
            <option value="content-writer">âœï¸ Content Writer</option>
          </select>
        </div>

        <!-- Quick Settings -->
        <div class="sidebar-section">
          <h3>âš™ï¸ Settings</h3>
          <div class="setting-item">
            <label>Model</label>
            <select id="model-select" class="select-input">
              <option value="qwen2.5-coder:32b">Qwen 2.5 Coder 32B</option>
              <option value="qwen2.5-coder:14b">Qwen 2.5 Coder 14B</option>
              <option value="llama3.2:latest">Llama 3.2</option>
            </select>
          </div>
          <div class="setting-item">
            <label>Temperature: <span id="temp-value">0.7</span></label>
            <input type="range" id="temperature" min="0" max="2" step="0.1" value="0.7">
          </div>
          <div class="setting-item">
            <label>Max Tokens: <span id="tokens-value">4096</span></label>
            <input type="range" id="max-tokens" min="512" max="8192" step="512" value="4096">
          </div>
        </div>

        <!-- Advanced Mode Controls -->
        <div class="sidebar-section">
          <h3>ğŸš€ Advanced Modes</h3>
          
          <div class="setting-item">
            <label style="display: flex; align-items: center; cursor: pointer; padding: 8px; background: #f0fdf4; border-radius: 6px; margin-bottom: 8px;">
              <input type="checkbox" id="iterative-mode" style="width: 18px; height: 18px; margin-right: 10px; cursor: pointer;">
              <div>
                <div style="font-weight: 600; color: #059669;">ğŸ”„ Iterative Mode</div>
                <div style="font-size: 11px; color: #6b7280;">Multiple refinement passes</div>
              </div>
            </label>
          </div>

          <div class="setting-item" id="iterations-control" style="display: none; padding-left: 12px; margin-top: -4px; margin-bottom: 8px;">
            <label style="font-size: 12px;">Iterations: <span id="iterations-value">5</span></label>
            <input type="range" id="max-iterations" min="2" max="10" step="1" value="5" style="width: 100%;">
          </div>

          <div class="setting-item">
            <label style="display: flex; align-items: center; cursor: pointer; padding: 8px; background: #fef3c7; border-radius: 6px; margin-bottom: 8px;">
              <input type="checkbox" id="long-mode" style="width: 18px; height: 18px; margin-right: 10px; cursor: pointer;">
              <div>
                <div style="font-weight: 600; color: #d97706;">ğŸ“– Long Mode</div>
                <div style="font-size: 11px; color: #6b7280;">Extended context (8K+ tokens)</div>
              </div>
            </label>
          </div>

          <div class="setting-item">
            <label style="display: flex; align-items: center; cursor: pointer; padding: 8px; background: #ede9fe; border-radius: 6px;">
              <input type="checkbox" id="rag-enabled" checked style="width: 18px; height: 18px; margin-right: 10px; cursor: pointer;">
              <div>
                <div style="font-weight: 600; color: #7c3aed;">ğŸ§  RAG (Knowledge)</div>
                <div style="font-size: 11px; color: #6b7280;">Use memory & context</div>
              </div>
            </label>
          </div>
          
          <div class="setting-item">
            <label style="display: flex; align-items: center; cursor: pointer; padding: 8px; background: #dbeafe; border-radius: 6px;">
              <input type="checkbox" id="orchestration-enabled" style="width: 18px; height: 18px; margin-right: 10px; cursor: pointer;">
              <div>
                <div style="font-weight: 600; color: #2563eb;">ğŸ­ Multi-Agent</div>
                <div style="font-size: 11px; color: #6b7280;">Route to specialized agents</div>
              </div>
            </label>
          </div>
        </div>
        
        <!-- Agent Status (shown when orchestration enabled) -->
        <div class="sidebar-section" id="agent-status" style="display: none;">
          <h3>ğŸ¤– Active Agents</h3>
          <div id="agent-indicators" style="font-size: 12px;">
            <div class="agent-indicator" data-agent="planner">
              <span class="agent-icon">ğŸ¯</span>
              <span class="agent-name">Planner</span>
              <span class="agent-calls">0 calls</span>
            </div>
            <div class="agent-indicator" data-agent="code">
              <span class="agent-icon">ğŸ’»</span>
              <span class="agent-name">Code Gen</span>
              <span class="agent-calls">0 calls</span>
            </div>
            <div class="agent-indicator" data-agent="scraper">
              <span class="agent-icon">ğŸ•·ï¸</span>
              <span class="agent-name">Scraper</span>
              <span class="agent-calls">0 calls</span>
            </div>
            <div class="agent-indicator" data-agent="analyst">
              <span class="agent-icon">ğŸ“Š</span>
              <span class="agent-name">Analyst</span>
              <span class="agent-calls">0 calls</span>
            </div>
            <div class="agent-indicator" data-agent="researcher">
              <span class="agent-icon">ğŸ”</span>
              <span class="agent-name">Researcher</span>
              <span class="agent-calls">0 calls</span>
            </div>
          </div>
        </div>

        <!-- Token Estimate -->
        <div class="sidebar-section">
          <h3>ğŸ’° Cost Estimate</h3>
          <div id="token-estimate" style="font-size: 12px; color: #374151; padding: 12px; background: #f9fafb; border-radius: 6px; border: 1px solid #e5e7eb;">
            <strong>Estimated Cost:</strong><br>
            Input: ~0 tokens<br>
            Output: ~4,096 tokens<br>
            <span style="color: #6366f1; font-weight: 600;">Total: ~4,096 tokens</span>
          </div>
        </div>

        <!-- Context Files -->
        <div class="sidebar-section">
          <h3>ğŸ“ Context Files</h3>
          <div class="context-files-header">
            <button id="add-files-btn" class="btn btn-secondary btn-sm">+ Add Files</button>
            <input type="file" id="file-input" multiple hidden>
          </div>
          <div id="context-files-list" class="context-files-list">
            <div class="empty-state">No files added</div>
          </div>
        </div>

        <!-- Conversation History -->
        <div class="sidebar-section">
          <h3>ğŸ’¬ Conversations</h3>
          <div id="conversations-list" class="conversations-list">
            <div class="empty-state">No conversations yet</div>
          </div>
        </div>

        <!-- Stats -->
        <div class="sidebar-section sidebar-stats">
          <div class="stat-item">
            <span class="stat-label">Tokens Used</span>
            <span class="stat-value" id="tokens-used">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Messages</span>
            <span class="stat-value" id="messages-count">0</span>
          </div>
        </div>
      </div>

      <!-- Templates Tab Content -->
      <div class="sidebar-content" id="templates-tab" style="display: none;">
        <div class="sidebar-section">
          <h3>ğŸ­ Scraper Templates</h3>
          <button id="new-template-btn" class="btn btn-primary" style="width: 100%; margin-bottom: 12px;">+ New Template</button>
          <div id="templates-list"></div>
        </div>
      </div>

      <!-- Builder Tab Content -->
      <div class="sidebar-content" id="builder-tab" style="display: none;">
        <div class="sidebar-section">
          <h3>ğŸ› ï¸ Scraper Builder</h3>
          <p style="font-size: 12px; color: #6b7280; margin-bottom: 12px;">Configure your scraper settings</p>
          
          <div style="margin-top: 16px;">
            <label style="display: block; font-size: 12px; font-weight: 500; margin-bottom: 4px;">
              Target URL
            </label>
            <input 
              type="text" 
              id="scraper-url" 
              placeholder="https://example.com"
              style="width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 13px;"
            />
          </div>
          
          <div style="margin-top: 12px;">
            <label style="display: block; font-size: 12px; font-weight: 500; margin-bottom: 4px;">
              Selectors (JSON)
            </label>
            <textarea 
              id="scraper-selectors" 
              rows="10"
              placeholder='{\n  "title": "h1",\n  "content": ".article-body"\n}'
              style="width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px; font-family: 'Courier New', monospace;"
            ></textarea>
          </div>
          
          <div style="margin-top: 12px;">
            <label style="display: flex; align-items: center; font-size: 13px; cursor: pointer;">
              <input type="checkbox" id="requires-javascript" style="margin-right: 8px;" />
              Requires JavaScript rendering
            </label>
          </div>
          
          <button 
            id="test-scraper-btn"
            style="margin-top: 16px; width: 100%; padding: 10px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;"
          >
            ğŸš€ Test Scraper
          </button>
          
          <div id="scraper-results" style="margin-top: 16px; display: none;">
            <h4 style="font-size: 13px; margin-bottom: 8px;">Results:</h4>
            <pre style="background: #f3f4f6; padding: 12px; border-radius: 6px; font-size: 11px; overflow-x: auto; max-height: 300px;"></pre>
          </div>
        </div>
      </div>
      
      <!-- Agent Editor Tab Content -->
      <div class="sidebar-content" id="agent-editor-tab" style="display: none;">
        <div id="agent-editor-container"></div>
      </div>
      
      <!-- Workflows Tab Content -->
      <div class="sidebar-content" id="workflows-tab" style="display: none;">
        <div id="workflow-builder-container"></div>
      </div>
    </aside>

    <!-- Main Chat Area -->
    <main class="main-content">
      <!-- Chat View -->
      <div id="chat-view" class="view-content" style="display: flex; flex-direction: column; height: 100%;">
        <div class="chat-container" style="flex: 1; display: flex; flex-direction: column;">
          <div id="messages-container" class="messages-container" style="flex: 1; overflow-y: auto;">
            <!-- Welcome Message -->
            <div class="welcome-message">
              <h1>ğŸ‘‹ Welcome to AI Agent Studio</h1>
              <p>Your local LLM control center with full context awareness</p>
              <div class="quick-actions">
                <button class="quick-action" data-prompt="Help me build a web scraper for [URL]">
                  ğŸ•·ï¸ Build Web Scraper
                </button>
                <button class="quick-action" data-prompt="Review and improve this code">
                  ğŸ’» Code Review
                </button>
                <button class="quick-action" data-prompt="Analyze this data and create visualizations">
                  ğŸ“Š Data Analysis
                </button>
                <button class="quick-action" data-prompt="Write a technical article about">
                  âœï¸ Content Writing
                </button>
              </div>
            </div>
          </div>

          <!-- Input Area -->
          <div class="input-area">
            <div class="input-toolbar">
              <button id="attach-btn" class="toolbar-btn" title="Attach files">
                ğŸ“
              </button>
              <button id="code-btn" class="toolbar-btn" title="Insert code">
                &lt;/&gt;
              </button>
              <button id="template-btn" class="toolbar-btn" title="Use template">
                ğŸ“‹
              </button>
              <div class="toolbar-spacer"></div>
              <button id="stop-btn" class="toolbar-btn" title="Stop generation" style="display:none;">
                â¹ï¸ Stop
              </button>
              <button id="regenerate-btn" class="toolbar-btn" title="Regenerate response" style="display:none;">
                ğŸ”„ Regenerate
              </button>
            </div>
            
            <div class="input-wrapper">
              <textarea 
                id="message-input" 
                placeholder="Type your message... (Shift + Enter for new line)"
                rows="3"
              ></textarea>
              <button id="send-btn" class="send-btn">
                <span>Send</span>
                <span class="send-icon">â¤</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Template Editor View -->
      <div id="template-editor-view" class="view-content" style="display: none; height: 100%; overflow-y: auto;">
        <div id="template-editor"></div>
      </div>

      <!-- Scraper Builder View -->
      <div id="scraper-builder-view" class="view-content" style="display: none; height: 100%; overflow-y: auto;">
        <div id="scraper-builder"></div>
      </div>
    </main>
              </button>
              <button class="quick-action" data-prompt="Write a technical article about">
                âœï¸ Content Writing
              </button>
            </div>
          </div>
        </div>

        <!-- Input Area -->
        <div class="input-area">
          <div class="input-toolbar">
            <button id="attach-btn" class="toolbar-btn" title="Attach files">
              ğŸ“
            </button>
            <button id="code-btn" class="toolbar-btn" title="Insert code">
              &lt;/&gt;
            </button>
            <button id="template-btn" class="toolbar-btn" title="Use template">
              ğŸ“‹
            </button>
            <div class="toolbar-spacer"></div>
            <button id="stop-btn" class="toolbar-btn" title="Stop generation" style="display:none;">
              â¹ï¸ Stop
            </button>
            <button id="regenerate-btn" class="toolbar-btn" title="Regenerate response" style="display:none;">
              ğŸ”„ Regenerate
            </button>
          </div>

          <div class="input-wrapper">
            <textarea 
              id="message-input" 
              placeholder="Type your message... (Shift+Enter for new line)"
              rows="3"
            ></textarea>
            <button id="send-btn" class="send-btn">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                <path d="M2 10L18 2L12 18L10 12L2 10Z"/>
              </svg>
            </button>
          </div>

          <div class="input-status">
            <span id="status-text">Ready</span>
            <span class="status-indicator" id="status-indicator"></span>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script type="module" src="main-unified.js"></script>
</body>
</html>
